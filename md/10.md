# 해시

## 10-1 해시법

해시법은 검색뿐 아니라 데이터의 추가 삭제도 효율적으로 수행할 수 있다.

### 정렬된 배열에 새로운 값 추가

일반 배열은 요소를 추가 하거나 삭제할 때에 추가, 삭제한 이ㅇ후의 모든 요소를 하나씩 뒤로 이동하거나 당겨야 하는데 그 비용은 결코 작지 않다.

### 해시법

> 데이터를 저장할 인덱스를 간단한 연산으로 구하여 검색, 추가, 삭제를 효율적으로 수행.
>

>해시 테이블 : 해시값은 인덱스로 하여 원래의 키값을 저장한 배열

> 해시 함수 : 키값을 해시값으로 변환하는 과정
>
> 보통 여기에는 나머지를 구하는 연산, 혹은 나머지 연산을 다시 응용한 연산을 사용

> 해시 테이블의 각 요소를 버킷이라고 한다.

### 충돌

>키값과 해시값의 대응 관계가 반드시 1대 1이어야 하는 것은 아니다.
> 이렇게 저장할 버킷이 중복되는 현상을 충돌이라고 한다.

#### 충돌 대처법

>- 체인법: 해시값이 같은 요소를 연결 리스트를 관리
>- 오픈 주소법 : 빈 버킷을 찾을 때까지 해시를 반복

### 체인법

>해시값이 같은 데이터를 사슬 모양의 연결 리스트로 연결하는 방법, 오픈 해시법이라고도 한다.
> 

#### 해시값이 같은 데이터 저장.

13으로 나눈 값에 대한 해시테이블

| 해시인덱스 | 저장된 값(연결 순서대로 |
|-------|---------------|
| 0     | null          |
| 1     | 14            |
| 2     | null          |
| 3     | 29            |
| 4     | 69 -> 17      |
| 5     | 5             |
| 6     | 6             |
| 7     | 20 -> 33      |
| 8~12  | null          |


#### 버킷용 클래스 Node<K, V>

 개별 버킷을 나타낸 것.
 
3가지 필드가 존재.

>- key : 키값
>- data : 데이터
>- next : 체인에서 다음 노드에 대한 참조

[실습 10-1](../src/ch10/ChainHash.java)

Node<K,V>에는 3가지 메서드가 존재.

>- getKey : 키값을 그대로 반환
>- getValue : 데이터를 그대로 반환
>- hashCode 키값의 해시값을 반환

#### 해시 클래스 ChainHash<K,V> 필드

두 필드가 존재.

>- size : 해시 테이블의 용량(배열 table의 요솟수)
>- table : 해시 테이블을 저장하는 배열

#### 생성자 ChainHash
>- 비어있는 해시 테이블 생성. 매개변수 capacity는 해시 테이블의 용량.

#### 메서드 hashValue

>- 해시값을 구하는 메서드.
>- key의 해시값을 size로 나눈 나머지를 반환.


>충돌이 전혀 발생하지 않는다면 해시 함수로 인덱스를 구하는 것만으로 검색, 추가 삭제가 거의 완료되므로 시간 복잡도는 어느 것이나 O(1)이 된다.
>
>해시 테이블을 크게 하면 충돌 발생을 억제할 수는 있지만, 메모리를 많이 차지하게 되므로, 공간과 시간의 절충이라는 문제가 항상 따라 다닌다.
> 

#### 키값으로 요소를 검색하는 search 메서드

검색 과정은 다음과 같다.

>1. 해시 함수로 키값을 해시값으로 변환
>2. 해시값은 인덱스로 하는 버킷을 선택
>3. 선택한 버킷의 연결 리스트를 처음부터 순서대로 선형 검색. 키값과 같은 값을 찾으면 검색 성공. 끝까지 찾지 못 하면 검색 실패.


#### 요소를 추가하는 메서드 add

삽입 과정은 다음과 같다.

>1. 해시 함수가 키값을 해시값으로 변환
>2. 해시값을 인덱스로 하는 버킷을 선택
>3. 버킷이 가리키는 연결 리스트를 처음부터 순서대로 검색. 키값과 같은 값을 찾으면 키값이 이미 등록된 상태이므로 삽입에 실패. 끝까지 스캔하여 찾지 못하면 리스트의 맨 앞에 노드를 삽입.


#### 요소를 삭제하는 메서드 remove

삭제 과정은 다음과 같다.

>1. 해시 함수로 키값을 해시값으로 변환
>2. 해시값을 인덱스로 하는 버킷을 선택
>3. 버킷이 가리키는 연ㅇ결 리스트를 처음부터 순서대로 검색. 키값과 같은 값을 찾으면 그 노드를 리스트에서 삭제. 그렇지 않으면 삭제에 실패.

#### 해시 테이블의 모든 내용을 출력하는 메서드 dump

[실습 10-2](../src/ch10/ChainHashTester.java)

### 오픈 주소법

>충돌이 발생했을 때 재해시를 수행하여 비어 있는 버킷을 찾아내는 법, 닫힌 해시법이라고도 한다.

[실습 10-3](../src/ch10/OpenHash.java)
#### 요소 삽입

>재해시할 때 해시 메서드는 자유롭게 결정할 수 있다.

오픈 주소법은 빈 버킷을 만날 때까지 재해시를 여러 번 반복하므로 선형 탐사법이라고도 한다.

#### 요소 삭제

각 버킷에 다음 속성 중 하나를 부여한다.

>1. 데이터 저장
>2. 비어 있음
>3. 삭제 마침

#### 요소 검색

> 삭제 마침 속성을 만나면 원하는 값을 찾을 때까지 재해시를 수행

[실습 10-4](../src/ch10/OpenHashTester.java)